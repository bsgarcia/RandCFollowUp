function Q = get_qvalues(exp_name, sess, cho, cfcho, con, out, cfout, ntrials, model)

    
    data = load(sprintf('data/fit/%s_learning_%d', exp_name, sess));
    parameters = data.data('parameters');
    
    switch model
        case 1
            alpha1 = parameters{model}(:, 2);
            beta1 = parameters{model}(:, 1);
        case 2
            alpha1 = parameters{model}(:, 2);
            alpha2 = parameters{model}(:, 3);
    alpha1 = parameters(1, :, 2);
    ntrials = size(cho, 2);
    beta1 = parameters(1, :, 1);
    % ----------------------------------------------------------%
    % Parameters                                                %
    % ----------------------------------------------------------%
    sim_params.noptions = 2;
    sim_params.ntrials = ntrials;
    sim_params.nsub = size(cho, 1);
    sim_params.ncond = length(unique(con));
    sim_params.con = con;
    sim_params.show_window = true;
    %sim_params.beta1 = beta1;
    sim_params.params = params;
    sim_params.out = out;
    sim_params.cfout = cfout;
    sim_params.cho = cho;
    sim_params.cfcho = cfcho;
    sim_params.model = model;

    Q = simulation(sim_params);
    % ---------------------------------------------------------%
end
